import{f as er,g as rr,r as z,j as ne}from"./index-Bluomjo3.js";var b={},ce,be;function nr(){if(be)return ce;be=1;var u=typeof Element<"u",E=typeof Map=="function",M=typeof Set=="function",_=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function P(t,o){if(t===o)return!0;if(t&&o&&typeof t=="object"&&typeof o=="object"){if(t.constructor!==o.constructor)return!1;var e,n,s;if(Array.isArray(t)){if(e=t.length,e!=o.length)return!1;for(n=e;n--!==0;)if(!P(t[n],o[n]))return!1;return!0}var i;if(E&&t instanceof Map&&o instanceof Map){if(t.size!==o.size)return!1;for(i=t.entries();!(n=i.next()).done;)if(!o.has(n.value[0]))return!1;for(i=t.entries();!(n=i.next()).done;)if(!P(n.value[1],o.get(n.value[0])))return!1;return!0}if(M&&t instanceof Set&&o instanceof Set){if(t.size!==o.size)return!1;for(i=t.entries();!(n=i.next()).done;)if(!o.has(n.value[0]))return!1;return!0}if(_&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(o)){if(e=t.length,e!=o.length)return!1;for(n=e;n--!==0;)if(t[n]!==o[n])return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof o.valueOf=="function")return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof o.toString=="function")return t.toString()===o.toString();if(s=Object.keys(t),e=s.length,e!==Object.keys(o).length)return!1;for(n=e;n--!==0;)if(!Object.prototype.hasOwnProperty.call(o,s[n]))return!1;if(u&&t instanceof Element)return!1;for(n=e;n--!==0;)if(!((s[n]==="_owner"||s[n]==="__v"||s[n]==="__o")&&t.$$typeof)&&!P(t[s[n]],o[s[n]]))return!1;return!0}return t!==t&&o!==o}return ce=function(o,e){try{return P(o,e)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}},ce}var B={},fe={},xe;function ke(){return xe||(xe=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.getDimensions=u.getPropDimension=u.getDimension=void 0;var E=function(t,o){return o.current?typeof t=="function"?t(o.current):t:0};u.getDimension=E;var M=function(t){var o=t.width,e=t.height,n=t.img;return{width:(0,u.getDimension)(o,n),height:(0,u.getDimension)(e,n)}};u.getPropDimension=M;var _=function(t,o){var e=o.width,n=o.height,s=o.img,i=o.responsive,l=o.parentWidth,c=o.natural,d=(0,u.getPropDimension)({width:e,height:n,img:s}),f=d.width,h=d.height;if(s.current){var a=s.current,v=a.naturalWidth,y=a.naturalHeight,r=a.clientWidth,p=a.clientHeight;if(t==="width")return i?l:c?v:f||r;if(t==="height")return i?p:c?y:h||p}return 0},P=function(t){return{width:_("width",t),height:_("height",t)}};u.getDimensions=P}(fe)),fe}var Oe;function tr(){if(Oe)return B;Oe=1;var u=B&&B.__assign||function(){return u=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++){o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},u.apply(this,arguments)};Object.defineProperty(B,"__esModule",{value:!0}),B.getExtendedArea=void 0;var E=ke(),M=function(t,o){var e=o.width,n=o.height,s=o.img,i=o.responsive,l=o.parentWidth,c=o.imgWidth;return t.map(function(d){if(i&&l&&s.current)return d/(s.current.naturalWidth/l);var f=(0,E.getPropDimension)({width:e,height:n,img:s}).width,h=f&&c>0?f/c:1;return d*h})},_=function(t,o){switch(t){case"circle":return[o[0],o[1]];case"poly":case"rect":default:{var e=o.length/2,n=o.reduce(function(l,c,d){var f=l.y,h=l.x;return d%2?{y:f+c/e,x:h}:{y:f,x:h+c/e}},{y:0,x:0}),s=n.y,i=n.x;return[i,s]}}},P=function(t,o,e){var n,s,i,l,c=e.fillColor,d=e.lineWidth,f=e.strokeColor,h=M(t.coords,o),a=_(t.shape,h);return u(u({},t),{scaledCoords:h,center:a,active:(n=t.active)!==null&&n!==void 0?n:!0,fillColor:(s=t.fillColor)!==null&&s!==void 0?s:c,lineWidth:(i=t.lineWidth)!==null&&i!==void 0?i:d,strokeColor:(l=t.strokeColor)!==null&&l!==void 0?l:f})};return B.getExtendedArea=P,B}var H={},We;function or(){if(We)return H;We=1,Object.defineProperty(H,"__esModule",{value:!0}),H.generateProps=H.rerenderPropsList=void 0,H.rerenderPropsList=["src","name","areaKeyName","isMulti","toggle","active","disabled","fillColor","strokeColor","lineWidth","imgWidth","width","height","natural","responsive","parentWidth"];var u={areaKeyName:"id",isMulti:!0,toggle:!1,active:!0,disabled:!1,fillColor:"rgba(255, 255, 255, 0.5)",strokeColor:"rgba(0, 0, 0, 0.5)",lineWidth:1,imgWidth:0,width:0,height:0,natural:!1,responsive:!1,parentWidth:0,containerProps:null,imgProps:null,canvasProps:null,mapProps:null,areaProps:null,onChange:null,onImageClick:null,onImageMouseMove:null,onClick:null,onMouseDown:null,onMouseUp:null,onTouchStart:null,onTouchEnd:null,onMouseMove:null,onMouseEnter:null,onMouseLeave:null,onLoad:null},E=function(M){return Object.entries(u).reduce(function(_,P){var t,o=P,e=o[0],n=o[1];return _[e]=(t=M[e])!==null&&t!==void 0?t:n,_},{src:M.src,name:M.name,areas:M.areas})};return H.generateProps=E,H}var T={},je;function ir(){if(je)return T;je=1;var u=T&&T.__rest||function(e,n){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(e);l<i.length;l++)n.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(s[i[l]]=e[i[l]]);return s},E=T&&T.__spreadArray||function(e,n,s){if(s||arguments.length===2)for(var i=0,l=n.length,c;i<l;i++)(c||!(i in n))&&(c||(c=Array.prototype.slice.call(n,0,i)),c[i]=n[i]);return e.concat(c||Array.prototype.slice.call(n))};Object.defineProperty(T,"__esModule",{value:!0});var M=function(e,n){var s=e.scaledCoords,i=e.fillColor,l=e.lineWidth,c=e.strokeColor,d=s[0],f=s[1],h=s[2],a=s[3];return n.current.fillStyle=i,n.current.lineWidth=l,n.current.strokeStyle=c,n.current.strokeRect(d,f,h-d,a-f),n.current.fillRect(d,f,h-d,a-f),!0},_=function(e,n){var s=e.scaledCoords,i=e.fillColor,l=e.lineWidth,c=e.strokeColor,d=s[0],f=s[1],h=s[2];return n.current.fillStyle=i,n.current.beginPath(),n.current.lineWidth=l,n.current.strokeStyle=c,n.current.arc(d,f,h,0,2*Math.PI),n.current.closePath(),n.current.stroke(),n.current.fill(),!0},P=function(e,n){var s=e.scaledCoords,i=e.fillColor,l=e.lineWidth,c=e.strokeColor,d=s.reduce(function(f,h,a,v){return a%2?f:E(E([],f,!0),[v.slice(a,a+2)],!1)},[]);return n.current.fillStyle=i,n.current.beginPath(),n.current.lineWidth=l,n.current.strokeStyle=c,d.forEach(function(f){var h=f[0],a=f[1];return n.current.lineTo(h,a)}),n.current.closePath(),n.current.stroke(),n.current.fill(),!0},t=function(e){return e==="rect"?M:e==="circle"?_:e==="poly"?P:!1},o=function(e,n){var s=e.shape,i=u(e,["shape"]),l=t(s);if(l&&n.current instanceof CanvasRenderingContext2D){var c={current:n.current};return l(i,c)}return!1};return T.default=o,T}var w={},Ae;function ar(){if(Ae)return w;Ae=1,Object.defineProperty(w,"__esModule",{value:!0}),w.touchEnd=w.touchStart=w.mouseUp=w.mouseDown=w.mouseMove=w.click=w.mouseLeave=w.mouseEnter=w.imageClick=w.imageMouseMove=void 0;var u=function(i){return function(l){var c=i.onImageMouseMove;c&&c(l)}};w.imageMouseMove=u;var E=function(i){return function(l){var c=i.onImageClick;c&&(l.preventDefault(),c(l))}};w.imageClick=E;var M=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onMouseEnter,a=l.cb;a&&a(c),h&&h(c,d,f)}};w.mouseEnter=M;var _=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onMouseLeave,a=l.cb;a&&a(c),h&&h(c,d,f)}};w.mouseLeave=_;var P=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onClick,a=l.cb;a&&a(c),h&&(f.preventDefault(),h(c,d,f))}};w.click=P;var t=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onMouseMove;h&&h(c,d,f)}};w.mouseMove=t;var o=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onMouseDown;h&&h(c,d,f)}};w.mouseDown=o;var e=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onMouseUp;h&&h(c,d,f)}};w.mouseUp=e;var n=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onTouchStart;h&&h(c,d,f)}};w.touchStart=n;var s=function(i,l){var c=i.area,d=i.index;return function(f){var h=l.onTouchEnd;h&&h(c,d,f)}};return w.touchEnd=s,w}var Z={},De;function ur(){if(De)return Z;De=1;var u=Z&&Z.__assign||function(){return u=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++){o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},u.apply(this,arguments)};Object.defineProperty(Z,"__esModule",{value:!0});var E={position:"absolute",top:0,left:0},M=u(u({},E),{zIndex:1,userSelect:"none"}),_=u(u({},M),{width:"100%",height:"auto"}),P={container:{position:"relative"},canvas:u(u({},E),{pointerEvents:"none",zIndex:2}),img:function(t){return t?_:M},map:function(t){return t?{cursor:"pointer"}:void 0}};return Z.default=P,Z}var Re;function lr(){if(Re)return b;Re=1;var u=b&&b.__assign||function(){return u=Object.assign||function(a){for(var v,y=1,r=arguments.length;y<r;y++){v=arguments[y];for(var p in v)Object.prototype.hasOwnProperty.call(v,p)&&(a[p]=v[p])}return a},u.apply(this,arguments)},E=b&&b.__createBinding||(Object.create?function(a,v,y,r){r===void 0&&(r=y);var p=Object.getOwnPropertyDescriptor(v,y);(!p||("get"in p?!v.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return v[y]}}),Object.defineProperty(a,r,p)}:function(a,v,y,r){r===void 0&&(r=y),a[r]=v[y]}),M=b&&b.__setModuleDefault||(Object.create?function(a,v){Object.defineProperty(a,"default",{enumerable:!0,value:v})}:function(a,v){a.default=v}),_=b&&b.__importStar||function(){var a=function(v){return a=Object.getOwnPropertyNames||function(y){var r=[];for(var p in y)Object.prototype.hasOwnProperty.call(y,p)&&(r[r.length]=p);return r},a(v)};return function(v){if(v&&v.__esModule)return v;var y={};if(v!=null)for(var r=a(v),p=0;p<r.length;p++)r[p]!=="default"&&E(y,v,r[p]);return M(y,v),y}}(),P=b&&b.__rest||function(a,v){var y={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&v.indexOf(r)<0&&(y[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,r=Object.getOwnPropertySymbols(a);p<r.length;p++)v.indexOf(r[p])<0&&Object.prototype.propertyIsEnumerable.call(a,r[p])&&(y[r[p]]=a[r[p]]);return y},t=b&&b.__spreadArray||function(a,v,y){if(y||arguments.length===2)for(var r=0,p=v.length,m;r<p;r++)(m||!(r in v))&&(m||(m=Array.prototype.slice.call(v,0,r)),m[r]=v[r]);return a.concat(m||Array.prototype.slice.call(v))},o=b&&b.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0});var e=_(er()),n=o(nr()),s=tr(),i=or(),l=ke(),c=o(ir()),d=ar(),f=o(ur()),h=function(a){var v=a.ref,y=P(a,["ref"]),r=(0,i.generateProps)(y),p=r.src,m=r.name,A=r.areas,F=r.areaKeyName,te=r.isMulti,Se=r.toggle,ae=r.active,Ie=r.disabled,de=r.fillColor,ve=r.strokeColor,he=r.lineWidth,pe=r.imgWidth,D=r.width,R=r.height,ge=r.natural,U=r.responsive,k=r.parentWidth,oe=r.containerProps,L=r.imgProps,q=r.canvasProps,$=r.mapProps,O=r.areaProps,me=r.onChange,Ne=r.onImageClick,Le=r.onImageMouseMove,ye=r.onClick,qe=r.onMouseDown,$e=r.onMouseUp,ze=r.onTouchStart,Te=r.onTouchEnd,Fe=r.onMouseMove,Ue=r.onMouseEnter,Be=r.onMouseLeave,ue=r.onLoad,Me=(0,e.useState)(!1),K=Me[0],He=Me[1],Ke=(0,e.useRef)(A),V=(0,e.useRef)(null),x=(0,e.useRef)(null),W=(0,e.useRef)(null),X=(0,e.useRef)(null),Ce=(0,e.useRef)(0),G=(0,e.useRef)(function(){return u({parentWidth:k},(0,l.getPropDimension)({width:D,height:R,img:x}))}()),we=(0,e.useMemo)(function(){return{width:D,height:R,responsive:U,parentWidth:k,natural:ge}},[D,R,U,k,ge]),J=(0,e.useMemo)(function(){return{width:D,height:R,responsive:U,parentWidth:k,imgWidth:pe}},[D,R,U,k,pe]),ee=(0,e.useMemo)(function(){return{fillColor:de,lineWidth:he,strokeColor:ve}},[de,he,ve]),_e=(0,e.useCallback)(function(){var g;!((g=x.current)===null||g===void 0)&&g.complete&&W.current&&V.current&&(X.current=W.current.getContext("2d"),He(!0))},[]);(0,e.useEffect)(function(){K?clearInterval(Ce.current):Ce.current=window.setInterval(_e,500)},[_e,K]);var ie=(0,e.useCallback)(function(){A.forEach(function(g){var C=(0,s.getExtendedArea)(g,u({img:x},J),ee);return C.preFillColor?(0,c.default)(u(u({},C),{fillColor:C.preFillColor}),X):!1})},[ee,A,J]),Ee=(0,e.useCallback)(function(){X.current&&W.current&&X.current.clearRect(0,0,W.current.width,W.current.height)},[]),le=(0,e.useCallback)(function(){Ee(),ie()},[Ee,ie]),Ve=function(g){var C=(0,s.getExtendedArea)(g,u({img:x},J),ee);return C.active?(0,c.default)(C,X):!1},Xe=function(g){var C=Ke.current,j=te?g:C.find(function(Y){return Y[F]===g[F]});if(j){var S=(0,s.getExtendedArea)(j,u({img:x},J),ee);if(ae&&S.active){var I=te?A:C,N=u({},j),re=function(){return Se?te&&N.preFillColor?!0:!te&&!!g.preFillColor:!1}();if(re){var se=I.find(function(Y){return Y[F]===g[F]});se!=null&&se.preFillColor&&delete N.preFillColor}else N.preFillColor=S.fillColor;var Je=I.map(function(Y){return Y[F]===g[F]?N:Y});me&&me(N,Je)}}},Q=(0,e.useCallback)(function(g,C){g===void 0&&(g=!0),C===void 0&&(C=!1);var j=(0,l.getDimensions)(u({img:x},we)),S=j.width,I=j.height;x.current&&W.current&&V.current&&X.current&&(V.current.style.width="".concat(S,"px"),V.current.style.height="".concat(I,"px"),g?Q(!1,!0):(x.current.width=S,x.current.height=I,W.current.width=S,W.current.height=I,ie()),ue&&C&&ue(x.current,{width:S,height:I}))},[we,ue,ie]),Pe=(0,e.useCallback)(function(){return{containerRef:V.current,imgRef:x.current,canvasRef:W.current}},[]);(0,e.useEffect)(function(){K&&Q()},[K]),(0,e.useEffect)(function(){le()},[A,le]),(0,e.useEffect)(function(){U&&k&&G.current.parentWidth!==k&&(Q(),G.current.parentWidth=k),D&&G.current.width!==D&&(Q(),G.current.width=(0,l.getDimension)(D,x)),R&&G.current.height!==R&&(Q(),G.current.height=(0,l.getDimension)(R,x))},[R,Q,k,U,D]),(0,e.useImperativeHandle)(v,function(){return{getRefs:Pe}},[Pe]);var Ge=function(g){ae&&Ve(g)},Qe=function(){ae&&le()},Ye=function(g){Xe(g)},Ze=function(){return A.map(function(g,C){var j,S=(0,s.getExtendedArea)(g,u({img:x},J),ee).scaledCoords;if(g.disabled)return null;var I=g.preFillColor,N=g.shape,re=g.href;return e.default.createElement("area",u({alt:"map"},O,{className:t(t(["img-mapper-area"],I?["img-mapper-area-highlighted"]:[],!0),O!=null&&O.className?[O.className]:[],!0).join(" "),key:(j=g[F])!==null&&j!==void 0?j:C.toString(),href:re??(O==null?void 0:O.href),shape:N??(O==null?void 0:O.shape),coords:S.join(","),onMouseEnter:(0,d.mouseEnter)({area:g,index:C},{onMouseEnter:Ue,cb:Ge}),onMouseLeave:(0,d.mouseLeave)({area:g,index:C},{onMouseLeave:Be,cb:Qe}),onMouseMove:(0,d.mouseMove)({area:g,index:C},{onMouseMove:Fe}),onMouseDown:(0,d.mouseDown)({area:g,index:C},{onMouseDown:qe}),onMouseUp:(0,d.mouseUp)({area:g,index:C},{onMouseUp:$e}),onTouchStart:(0,d.touchStart)({area:g,index:C},{onTouchStart:ze}),onTouchEnd:(0,d.touchEnd)({area:g,index:C},{onTouchEnd:Te}),onClick:(0,d.click)({area:g,index:C},{onClick:ye,cb:Ye})}))})};return e.default.createElement("div",u({},oe,{ref:V,id:"img-mapper",style:u(u({},oe==null?void 0:oe.style),f.default.container)}),e.default.createElement("img",u({role:"presentation",alt:"map"},L,{ref:x,src:p,useMap:"#".concat(m),className:t(["img-mapper-img"],L!=null&&L.className?[L.className]:[],!0).join(" "),style:u(u(u({},L==null?void 0:L.style),f.default.img(U)),K?null:{display:"none"}),onClick:(0,d.imageClick)({onImageClick:Ne}),onMouseMove:(0,d.imageMouseMove)({onImageMouseMove:Le})})),e.default.createElement("canvas",u({},q,{ref:W,className:t(["img-mapper-canvas"],q!=null&&q.className?[q.className]:[],!0).join(" "),style:u(u({},q==null?void 0:q.style),f.default.canvas)})),e.default.createElement("map",u({},$,{className:t(["img-mapper-map"],$!=null&&$.className?[$.className]:[],!0).join(" "),name:m,style:u(u({},$==null?void 0:$.style),f.default.map(ye))}),K&&!Ie&&Ze()))};return b.default=(0,e.memo)(h,function(a,v){var y=i.rerenderPropsList.some(function(r){return a[r]!==v[r]});return(0,n.default)(a.areas,v.areas)&&!y}),b}var sr=lr();const cr=rr(sr);function dr({slot:u,slotEmpty:E,camera:M,map:_,handleClick:P,isLabel:t=!0}){const[o,e]=z.useState([]),[n,s]=z.useState([]),[i,l]=z.useState(0),c=z.useRef(null);z.useEffect(()=>{const r=()=>{c.current&&l(c.current.offsetWidth)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),z.useEffect(()=>{const r=[...(u||[]).map(m=>({id:`${m.parking_id}`,shape:"circle",coords:[m.x_coordinate,m.y_coordinate,15],preFillColor:"red"})),...(E||[]).map(m=>({id:`${m.parking_id}`,shape:"circle",coords:[m.x_coordinate,m.y_coordinate,15],preFillColor:"green"})),...(M||[]).map(m=>({id:`${m.camera_id}`,shape:"circle",coords:[m.x_coordinate,m.y_coordinate,12],preFillColor:"blue"}))];e(r);const p=[...(u||[]).map(m=>({x:m.x_coordinate,y:m.y_coordinate,text:`${m.parking_id}`})),...(E||[]).map(m=>({x:m.x_coordinate,y:m.y_coordinate,text:`${m.parking_id}`})),...(M||[]).map(m=>({x:m.x_coordinate,y:m.y_coordinate,text:`${m.camera_id}`}))];s(p)},[u,M,E]);const[d,f]=z.useState("");z.useEffect(()=>{console.log(_),f(_==="B"?"/src/assets/zoneB.svg":"/src/assets/zoneA.svg")},[_]);const a=i<480?280:i<768?400:i<1024?700:800,v=a/1e3,y=r=>{var A;console.log("Area clicked:",r);const p=(A=r.id)==null?void 0:A.split("-")[0];r.preFillColor==="red"&&(console.log(`Clicked on slot ${p}`),P(r))};return ne.jsx("div",{ref:c,className:"w-full h-full flex justify-center items-center flex-col",children:ne.jsxs("div",{className:"relative w-full flex justify-center",children:[d&&ne.jsx(cr,{src:d,width:a,imgWidth:1e3,areas:o,name:"my-map",onClick:r=>y(r),ref:null}),t&&n.length>0&&ne.jsx("div",{className:"absolute top-0 left-0 w-full h-full pointer-events-none z-30",style:{width:`${a}px`,left:"50%",transform:"translateX(-50%)"},children:n.map((r,p)=>ne.jsx("div",{className:"absolute whitespace-nowrap",style:{left:`${r.x*v}px`,top:`${r.y*v}px`,transform:"translate(-50%, -50%)",color:"white",fontSize:`${Math.max(12*v,10)}px`,fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",zIndex:10,padding:"2px 4px",borderRadius:"2px"},children:r.text},p))})]})})}export{dr as M};
